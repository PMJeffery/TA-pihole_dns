# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/TA_pihole_dns/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/TA_pihole_dns/default
# into ../local and edit there.

#====================================
# pihole
#====================================
[pihole]
SHOULD_LINEMERGE             = false
LINE_BREAKER                 = ([\r\n]+)
NO_BINARY_CHECK              = true
TIME_FORMAT                  = %b %e %H:%M:%S
TIME_PREFIX                  = ^
MAX_TIMESTAMP_LOOKAHEAD      = 15
CHARSET                      = UTF-8
ANNOTATE_PUNCT               = false
FIELDALIAS-pihole_src        = src_ip AS src
EVAL-reply_code              = case(isnotnull(answer) AND answer=="0.0.0.0", "Refused", isnull(answer), null(), true(), "NoError")
REPORT-pihole_pid            = pihole_pid
REPORT-pihole_transaction_id = pihole_transaction_id
REPORT-pihole_src_src_port   = pihole_src_src_port
REPORT-pihole_query          = pihole_query
REPORT-pihole_response       = pihole_response
REPORT-pihole_response_local = pihole_response_local
REPORT-pihole_forwarded      = pihole_forwarded
REPORT-pihole_cached         = pihole_cached
REPORT-pihole_dhcp           = pihole_dhcp
REPORT-pihole_validation     = pihole_validation
REPORT-pihole_config         = pihole_config
LOOKUP-pihole_rcodes         = pihole_rcodes_lookup name AS reply_code OUTPUTNEW rcode AS reply_code_id, description AS rcode_decription
LOOKUP-pihole_rtypes         = pihole_rtypes_lookup type AS record_type OUTPUTNEW type_id AS record_type_id, description AS record_description

#====================================
# pihole FTL
#====================================
[pihole:ftl]
SHOULD_LINEMERGE          = false
LINE_BREAKER              = ([\r\n]+)
NO_BINARY_CHECK           = true
TIME_FORMAT               = %Y-%m-%d %H:%M:%S.%3N
TIME_PREFIX               = ^\[
MAX_TIMESTAMP_LOOKAHEAD   = 23
CHARSET                   = UTF-8
ANNOTATE_PUNCT            = false
REPORT-pihole_ftl_metrics = pihole_ftl_metrics
REPORT-pihole_ftl_config  = pihole_ftl_config
REPORT-pihole_ftl_msg     = pihole_ftl_msg
