# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/TA_pihole_dns/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/TA_pihole_dns/default
# into ../local and edit there.

#====================================
# Lookups
#====================================
[pihole_rcodes_lookup]
filename = pihole_rcodes.csv
default_match = unassigned
max_matches = 1
min_matches = 1

#====================================
# Field Extractions
#====================================
[pihole_pid]
REGEX = dnsmasq\[([^\]]*)\]
FORMAT = pid::$1

[pihole_transaction_id]
REGEX = dnsmasq\[[^\]]*\]\:\s(\d+)\s
FORMAT = transaction_id::$1

[pihole_src_src_port]
REGEX = dnsmasq\[[^\]]*\]\:\s\S+\s([^\/]*)\/(\S+)\s
FORMAT = src_ip::$1 src_port::$2

[pihole_query]
REGEX = query\[([^\]]*)\]\s+(\S+)
FORMAT = message_type::Query query_type::Query record_type::$1 query::$2

[pihole_response]
REGEX = reply\s+(\S+)\s+is\s+(.*)
FORMAT = message_type::Response response::reply query::$1 answer::$1

[pihole_response_local]
REGEX = (\/etc.*?)\s+(\S+)\s+is\s+(.*)
FORMAT = message_type::Response response::$1 query::$2 answer::$3

[pihole_forwarded]
REGEX = forwarded\s+(\S+)\s+to\s+(.*)
FORMAT = message_type::Response response::forwarded query::$1 dest::$2

[pihole_cached]
REGEX = cached\s+(\S+)\s+is\s+(.*)
FORMAT = message_type::Response response::cached query::$1 answer::$2

[pihole_dhcp]
REGEX = DHCP\s+(\S+)\s+is\s+(.*)
FORMAT = message_type::Response response::dhcp query::$1 answer::$2

[pihole_validation]
REGEX = validation\sresult\sis\s(\S+)
FORMAT = response::validation validation_result::$1

[pihole_config]
REGEX = (config.*)
FORMAT = config_msg::$1
